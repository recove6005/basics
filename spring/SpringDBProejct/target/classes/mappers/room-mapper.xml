<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.springdbproejct.mappers.RoomMapper">
    <resultMap id="user_in_room" type="RoomDTO">
        <id property="no" column="no" />
        <result property="capacity" column="capacity" />
        <collection property="userDTOS" javaType="list" ofType="UserDTO">
            <result property="id" column="id" />
            <result property="pw" column="pw" />
            <result property="nickName" column="nickName" />
            <result property="registDate" column="registDate" />
        </collection>
    </resultMap>

    <select id="get_room" parameterType="byte" resultMap="user_in_room">
        SELECT * FROM `user` U
        INNER JOIN `room` R
        ON U.`roomNo` = R.`no`
        WHERE R.`no` = #{no};
    </select>

    <select id="get_rooms" parameterType="int" resultType="RoomDTO">
        SELECT * FROM `room` WHERE `capacity` >= #{capacity}
    </select>

    <insert id="create_room" parameterType="RoomDTO">
        INSERT INTO `room` VALUES (NULL, #{capacity})
    </insert>

    <insert id="create_rooms">
        INSERT INTO `room` VALUES
        <foreach item="userDTO" collection="list" separator=",">
            (NULL, #{userDTO.capacity})
        </foreach>
    </insert>
<!--    <resultMap id="user_in_room" type="com.example.springdbproejct.dtos.RoomDTO">-->
<!--        <id property="no" column="no" />-->
<!--        <result property="capacity" column="capacity" />-->
<!--        <collection property="userDTOList" javaType="list" ofType="com.example.springdbproejct.dtos.UserDTO">-->
<!--            &lt;!&ndash; propert : 객체 이름, colume : DB 속성 이름 &ndash;&gt;-->
<!--            <result property="id" column="id"></result>-->
<!--            <result property="pw" column="pw"></result>-->
<!--            <result property="nickname" column="nickname"></result>-->
<!--            <result property="registDate" column="registDate"></result>-->
<!--        </collection>-->
<!--    </resultMap>-->
<!--    <select id="get_room" parameterType="byte" resultMap="user_in_room">-->
<!--        SELECT * FROM `user` U-->
<!--        INNER JOIN `room` R-->
<!--        ON U.`roomNo` = R.`no`-->
<!--        WHERE R.`no` = #{no};-->
<!--    </select>-->

<!--    <select id="get_rooms" parameterType="int" resultType="com.example.springdbproejct.dtos.RoomDTO">-->
<!--        SELECT * FROM `room` WHERE `capacity` >= #{capacity}-->
<!--    </select>-->
<!--    -->
<!--    &lt;!&ndash; <insert id="create_room" parameterType="com.example.springdbproejct.dtos.RoomDTO">&ndash;&gt;-->
<!--    &lt;!&ndash;     INSERT INTO `room` VALUES (#{no}, #{capacity}) &ndash;&gt;-->
<!--    &lt;!&ndash; </insert> &ndash;&gt;-->
<!--    <insert id="create_rooms">-->
<!--        &lt;!&ndash; insert 문 내에서 사용하는 foreach문&ndash;&gt;-->
<!--        INSERT INTO `room` VALUES-->
<!--        <foreach item="item" collection="list" separator=",">-->
<!--            (#{no}, #{capacity})-->
<!--        </foreach>-->
<!--    </insert>-->
    
</mapper>

